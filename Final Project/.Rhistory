library(tidyverse)
library(dplyr)
library(tidyr)
car_occupants_injured <- read_delim("Car.txt", delim = "\t", quote = '"')
motorcycle_occupants_injured <- read_delim("Motorcycle.txt", delim = "\t", quote = '"')
library(tidyverse)
library(dplyr)
library(tidyr)
car_occupants_injured <- read_delim("Car.txt", delim = "\t", quote = '"')
motorcycle_occupants_injured <- read_delim("Motorcycle.txt", delim = "\t", quote = '"')
truck_van_occupants_injured <- read_delim("statetruckvan.txt", delim = "\t", quote = '"')
car_occupants_injured <- car_occupants_injured %>%
separate('Census Region', c("Extra", "Census Region"), sep = ":\\s*") %>%
select(-Notes, -`Census Region Code`, -`Year Code`, -`State Code`, -`Crude Rate`) %>%
drop_na() %>%
filter(
Deaths != "Suppressed"
) %>%
mutate(
Deaths = as.numeric(Deaths),
rate = (Deaths / Population) * 100000
)
motorcycle_occupants_injured <- motorcycle_occupants_injured %>%
separate('Census Region', c("Extra", "Census Region"), sep = ":\\s*") %>%
select(-Notes, -`Census Region Code`, -`Year Code`, -`State Code`, -`Crude Rate`) %>%
drop_na() %>%
filter(
Deaths != "Suppressed"
) %>%
mutate(
Deaths = as.numeric(Deaths),
rate = (Deaths / Population) * 100000
)
car_occupants_injured <- car_occupants_injured %>%
separate('Census Region', c("Extra", "Census Region"), sep = ":\\s*") %>%
select(-Notes, -`Census Region Code`, -`Year Code`, -`State Code`, -`Crude Rate`, -`Race Code`, -`Gender Code`) %>%
drop_na() %>%
filter(
Deaths != "Suppressed"
) %>%
mutate(
Deaths = as.numeric(Deaths),
rate = (Deaths / Population) * 100000
)
library(tidyverse)
library(dplyr)
library(tidyr)
car_occupants_injured <- read_delim("Car.txt", delim = "\t", quote = '"')
motorcycle_occupants_injured <- read_delim("Motorcycle.txt", delim = "\t", quote = '"')
truck_van_occupants_injured <- read_delim("statetruckvan.txt", delim = "\t", quote = '"')
car_occupants_injured <- car_occupants_injured %>%
separate('Census Region', c("Extra", "Census Region"), sep = ":\\s*") %>%
select(-Notes, -`Census Region Code`, -`Year Code`, -`State Code`, -`Crude Rate`, -`Race Code`, -`Gender Code`) %>%
drop_na() %>%
filter(
Deaths != "Suppressed"
) %>%
mutate(
Deaths = as.numeric(Deaths),
rate = (Deaths / Population) * 100000
)
motorcycle_occupants_injured <- motorcycle_occupants_injured %>%
separate('Census Region', c("Extra", "Census Region"), sep = ":\\s*") %>%
select(-Notes, -`Census Region Code`, -`Year Code`, -`State Code`, -`Crude Rate`, -`Race Code`, -`Gender Code`) %>%
drop_na() %>%
filter(
Deaths != "Suppressed"
) %>%
mutate(
Deaths = as.numeric(Deaths),
rate = (Deaths / Population) * 100000
)
truck_van_occupants_injured <- truck_van_occupants_injured %>%
separate('Census Region', c("Extra", "Census Region"), sep = ":\\s*") %>%
select(-Notes, -`Census Region Code`, -`Year Code`, -`State Code`, -`Crude Rate`, -`Race Code`, -`Gender Code`) %>%
drop_na() %>%
filter(
Deaths != "Suppressed"
) %>%
mutate(
Deaths = as.numeric(Deaths),
rate = (Deaths / Population) * 100000
)
combined_data <- car_occupants_injured %>%
mutate(Vehicle = "Car") %>%
select(Census.Region = `Census Region`, State, Year, Deaths, Population, rate, Vehicle) %>%
bind_rows(
motorcycle_occupants_injured %>%
mutate(Vehicle = "Motorcycle") %>%
select(Census.Region = `Census Region`, State, Year, Deaths, Population, rate, Vehicle),
truck_van_occupants_injured %>%
mutate(Vehicle = "Truck/Van") %>%
select(Census.Region = `Census Region`, State, Year, Deaths, Population, rate, Vehicle)
)
combined_data_yearly <- combined_data %>%
group_by(Year, Vehicle) %>%
summarise(Total_Deaths = sum(Deaths, na.rm = TRUE), .groups = "drop") %>%
mutate(Year = as.numeric(Year))
ggplot(combined_data_yearly, aes(x = Year, y = Total_Deaths, color = Vehicle, shape = Vehicle)) +
geom_point(size = 3, alpha = 0.8) +
geom_smooth(method = "loess", se = FALSE, linetype = "dotted", size = 1) +
theme_minimal() +
scale_x_continuous(
breaks = seq(min(combined_data_yearly$Year), max(combined_data_yearly$Year), by = 3)
) +
scale_y_continuous(labels = scales::comma) +
labs(
title = "Scatter Plot of Fatal Crashes by Vehicle Type",
subtitle = "Each point represents total deaths in a given year for a specific vehicle type",
x = "Year",
y = "Total Deaths",
color = "Vehicle Type",
shape = "Vehicle Type"
) +
theme(
legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(face = "bold", size = 15),
plot.subtitle = element_text(size = 13)
)
combined_data %>%
mutate(Year = as.numeric(Year)) %>%
group_by(Year, `Census.Region`) %>%
summarize(mean_rate = mean(rate, na.rm = TRUE), .groups = "drop") %>%
ggplot(aes(x = Year, y = mean_rate, color = `Census.Region`, group = `Census.Region`)) +
geom_line(size = 1) +
geom_point(size = 2) +
labs(
title = "Death Rates Over Time by Region",
x = "Year",
y = "Average Death Rate (per 100,000)",
color = "Region"
) +
scale_x_continuous(breaks = seq(1999, 2020, by = 3)) +
scale_fill_manual(values = c("#7300bf", "#4bbf00", "#bf1400", "#00abbf")) +
theme_bw() +
theme(
plot.title = element_text(face = "bold", size = 14),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position = 'top'
)
# Stacked Bar Graph for Death Rate in the Midwest by Year
midwest_deaths_data_rate <- combined_data %>%
filter(`Census.Region` == "Midwest") %>%
group_by(Year, Vehicle) %>%
summarise(Average_Rate = mean(rate, na.rm = TRUE), .groups = "drop")
ggplot(midwest_deaths_data_rate, aes(x = Year, y = Average_Rate, fill = Vehicle)) +
geom_bar(stat = "identity", position = "stack") +
labs(
title = "Stacked Bar Graph of Death Rates in the Midwest by Year",
x = "Year",
y = "Average Death Rate (per 100,000)",
fill = "Vehicle Type"
) +
scale_fill_manual(values = c("#7300bf", "#4bbf00", "#00abbf")) +  # Customize colors
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 16),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "top",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10)
)
# Line Plot for Death Rates in the Midwest by Race and Gender
midwest_race_gender_trends <- combined_data %>%
filter(`Census.Region` == "Midwest") %>%
group_by(Year, Race, Gender) %>%
summarise(Average_Rate = mean(rate, na.rm = TRUE), .groups = "drop")
